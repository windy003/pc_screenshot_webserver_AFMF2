# Windows 文件共享服务器

这是一个基于 Flask 的文件共享服务器，可以将 Windows 上的目录通过 Web 界面共享给局域网内的其他设备访问。

## 功能特性

- ✅ 文件浏览和下载
- ✅ 文件上传
- ✅ 文件和文件夹删除
- ✅ 创建新文件夹
- ✅ 简单的密码认证
- ✅ 简洁实用的界面
- ✅ 支持大文件上传 (最大 500MB)
- ✅ 安全的路径访问控制

## 安装步骤

### 1. 安装 Python

确保你的 Windows 系统已安装 Python 3.7 或更高版本。

检查 Python 版本：
```bash
python --version
```

### 2. 安装依赖

在项目目录下打开命令提示符或 PowerShell，运行：

```bash
pip install -r requirements.txt
```

## 配置

配置文件使用 `.env` 文件，方便自定义设置。

### 配置步骤

1. 项目中已包含 `.env` 文件，直接修改即可
2. 或者复制 `.env.example` 为 `.env`：
   ```bash
   copy .env.example .env
   ```

3. 编辑 `.env` 文件，修改以下配置：

```env
# 共享目录路径（修改为你要共享的目录）
SHARED_DIRECTORY=D:\shared

# 登录用户名
USERNAME=admin

# 登录密码（请修改默认密码！）
PASSWORD=admin123

# 服务器端口
PORT=5000

# 最大上传文件大小（MB）
MAX_UPLOAD_SIZE=500
```

### 配置说明

- **SHARED_DIRECTORY**: 要共享的目录路径
  - 示例: `D:\shared`
  - 示例: `C:\Users\YourName\Documents\Shared`

- **USERNAME**: 登录用户名

- **PASSWORD**: 登录密码（强烈建议修改默认密码！）

- **PORT**: Web服务器端口（默认 5000）

- **HOST**: 服务器主机
  - `0.0.0.0` - 允许局域网访问（推荐）
  - `127.0.0.1` - 仅本机访问

- **DEBUG**: 调试模式
  - `True` - 开发环境
  - `False` - 生产环境（推荐）

- **MAX_UPLOAD_SIZE**: 最大上传文件大小（MB）

## 运行服务器

在项目目录下运行：

```bash
python app.py
```

你会看到类似这样的输出：

```
正在共享目录: D:\shared
默认用户名: admin
默认密码: admin123

访问地址:
  本机: http://127.0.0.1:5000
  局域网: http://<你的IP地址>:5000

按 Ctrl+C 停止服务器
```

## 访问服务器

### 在本机访问

打开浏览器，访问：`http://127.0.0.1:5000`

### 在局域网其他设备访问

1. 查看你的 IP 地址：
   ```bash
   ipconfig
   ```
   找到 `IPv4 地址`，例如：`192.168.1.100`

2. 在其他设备的浏览器中访问：
   ```
   http://192.168.1.100:5000
   ```

3. 输入用户名和密码登录

## 使用说明

### 浏览文件

- 点击文件夹可以进入该文件夹
- 点击文件名或"下载"按钮可以下载文件
- 使用顶部的面包屑导航可以快速返回上级目录

### 上传文件

1. 点击"上传文件"按钮
2. 选择要上传的文件
3. 点击"上传"

### 创建文件夹

1. 点击"创建文件夹"按钮
2. 输入文件夹名称
3. 点击"创建"

### 删除文件/文件夹

1. 找到要删除的项目
2. 点击"删除"按钮
3. 确认删除

## 安全建议

1. **修改默认密码**：部署前请务必修改默认密码
2. **防火墙设置**：确保防火墙允许 5000 端口（或你设置的端口）
3. **仅局域网使用**：此服务器仅适合在局域网内使用，不建议直接暴露到公网
4. **定期备份**：重要文件请定期备份

## 高级配置

所有配置都可以在 `.env` 文件中修改，无需改动代码。

### 修改端口

在 `.env` 文件中修改：

```env
PORT=8080
```

### 修改上传大小限制

在 `.env` 文件中修改（单位：MB）：

```env
MAX_UPLOAD_SIZE=1000
```

### 仅允许本机访问

在 `.env` 文件中修改：

```env
HOST=127.0.0.1
```

### 生产环境部署

生产环境建议使用 Waitress 或 Gunicorn：

```bash
pip install waitress
```

然后运行：

```bash
waitress-serve --host=0.0.0.0 --port=5000 app:app
```

## 常见问题

### Q: 无法访问服务器？

A: 检查以下几点：
1. 服务器是否正在运行
2. 防火墙是否允许访问
3. IP 地址是否正确
4. 端口号是否正确

### Q: 上传大文件失败？

A: 在 `.env` 文件中检查 `MAX_UPLOAD_SIZE` 设置，确保大于文件大小，然后重启服务器。

### Q: 忘记密码怎么办？

A: 在 `.env` 文件中修改 `PASSWORD` 配置，然后重启服务器。

### Q: 如何修改共享目录？

A: 在 `.env` 文件中修改 `SHARED_DIRECTORY` 配置，然后重启服务器。

## 项目结构

```
.
├── app.py              # 主应用文件
├── templates/          # HTML 模板目录
│   ├── index.html     # 文件浏览页面
│   └── login.html     # 登录页面
├── .env                # 配置文件（需自行配置）
├── .env.example        # 配置文件示例
├── requirements.txt    # Python 依赖
├── start.bat           # Windows 启动脚本
└── README.md          # 使用说明
```

## 许可

本项目仅供学习和个人使用。
